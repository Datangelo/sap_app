{% extends "base.html" %}

{% block title %}AWS Tool{% endblock %}

{% block content %}
<h2>AWS Tool</h2>

<!-- Run AWS Tool Form -->
<form method="POST">
  <label for="country">Country:</label>
  <select name="country" id="country" required>
    <option value="">-- Select --</option>
    <option value="BE">Belgium (BE)</option>
    <option value="AT">Austria (AT)</option>
    <option value="ES">Spain (ES)</option>
    <!-- add more -->
  </select>
  <br><br>

  <label for="start_date">Start Date:</label>
  <input type="date" name="start_date" required>
  <br><br>

  <label for="end_date">End Date:</label>
  <input type="date" name="end_date" required>
  <br><br>

  <button type="submit">Run Tool</button>
</form>

<hr>

<!-- Upload Credit File Form -->
<h3>Upload Credit File</h3>
<form action="{{ url_for('upload_credits') }}" method="post" enctype="multipart/form-data">
  <input type="file" name="file" accept=".csv,.xlsx" required>
  <button type="submit">Upload & Apply Credits</button>
</form>


{% if result %}
  <h3>Result:</h3>
  {% if result.error %}
    <p style="color:red;">Error: {{ result.error }}</p>
  {% else %}
    <p>Period: {{ result.final_df_message }}</p>
    <p>Country: {{ result.country }}</p>
    <p>Seller Cost (sum): {{ result.seller_sum }}</p>
    <p>Customer Cost (sum): {{ result.customer_sum }}</p>

    <!-- Download Button -->
    <form action="{{ url_for('download_csv') }}" method="get">
      <button type="submit">Download Full CSV</button>
    </form>
  {% endif %}
{% endif %}
{% endblock %}

